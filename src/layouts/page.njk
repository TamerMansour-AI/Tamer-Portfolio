<!doctype html>
<html lang="{{ lang or 'en' }}" {% if lang == 'ar' %}dir="rtl"{% endif %}>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ title or site.title }}</title>
  <meta name="theme-color" content="#5a6b2c">

  {% set desc = description or site.defaultDescription %}
  <meta name="description" content="{{ desc }}">
  <meta property="og:title" content="{{ title or site.title }}">
  <meta property="og:description" content="{{ desc }}">
  <meta property="og:type" content="website">
  <meta property="og:url" content="{{ site.url }}{{ page.url }}">
  <link rel="canonical" href="{{ site.url }}{{ page.url }}">

  <link rel="stylesheet" href="{{ '/styles.css' | url }}{% if site.assetVersion %}?v={{ site.assetVersion }}{% endif %}">
</head>
<body>
  <a class="skip-link" href="#main-content">Skip to content</a>

  {% if lang == 'ar' %}
    {% set base = '/ar' %}
    {% set l_home = 'الرئيسية' %}
    {% set l_projects = 'المشاريع' %}
    {% set l_media = 'الوسائط' %}
    {% set l_gallery = 'المعرض' %}
    {% set l_music = 'الموسيقى' %}
    {% set l_research = 'الأبحاث' %}
    {% set l_training = 'التدريب والاستشارات' %}
    {% set l_blog = 'المدونة' %}
    {% set l_about = 'نبذة' %}
    {% set l_contact = 'تواصل' %}
    {% set l_lang_toggle = 'English' %}
    {% set current = page.url or '/' %}
    {% set altUrlRaw = current
       | replace('/ar/index.html','/')
       | replace('/ar/','/')
       | replace('/ar','/') %}
  {% else %}
    {% set base = '' %}
    {% set l_home = 'Home' %}
    {% set l_projects = 'Projects' %}
    {% set l_media = 'Media' %}
    {% set l_gallery = 'Gallery' %}
    {% set l_music = 'Music' %}
    {% set l_research = 'Research' %}
    {% set l_training = 'Training &amp; Consulting' %}
    {% set l_blog = 'Blog' %}
    {% set l_about = 'About' %}
    {% set l_contact = 'Contact' %}
    {% set l_lang_toggle = 'العربية' %}
    {% set current = page.url or '/' %}
    {% if current == '/' or current == '/index.html' %}
      {% set altUrlRaw = '/ar/' %}
    {% else %}
      {% set altUrlRaw = '/ar' + current %}
    {% endif %}
  {% endif %}

  <header class="site-header">
    <div class="container nav-row">
      <a class="logo" href="{{ (base + '/') | url }}">TM</a>

      {# top language switch always visible #}
      <a class="lang-switch-top" href="{{ altUrlRaw | url }}">{{ l_lang_toggle }}</a>

      {% if lang != 'ar' %}
        {# LTR: hamburger + overlay nav #}
        <button class="nav-toggle" aria-expanded="false" aria-controls="primary-nav" aria-label="Open menu" aria-haspopup="true">☰</button>

        <nav id="primary-nav" class="nav-links" aria-label="Primary">
          <a href="{{ (base + '/') | url }}">{{ l_home | safe }}</a>
          <a href="{{ (base + '/projects/') | url }}">{{ l_projects | safe }}</a>
          <a href="{{ (base + '/media/') | url }}">{{ l_media | safe }}</a>
          <a href="{{ (base + '/gallery/') | url }}">{{ l_gallery | safe }}</a>
          <a href="{{ (base + '/music/') | url }}">{{ l_music | safe }}</a>
          <a href="{{ (base + '/research/') | url }}">{{ l_research | safe }}</a>
          <a href="{{ (base + '/training-consulting/') | url }}">{{ l_training | safe }}</a>
          {% if (collections.posts and collections.posts | length > 0) or (collections.posts_en and collections.posts_en | length > 0) or (collections.posts_ar and collections.posts_ar | length > 0) %}
            <a href="{{ (base + '/blog/') | url }}">{{ l_blog | safe }}</a>
          {% endif %}
          <a href="{{ (base + '/about/') | url }}">{{ l_about | safe }}</a>
          <a href="{{ (base + '/contact/') | url }}">{{ l_contact | safe }}</a>
        </nav>
      {% else %}
        {# RTL: simplified static nav (short list) - no overlay #}
        <nav class="nav-links-rtl" aria-label="Primary (Arabic)">
          <a href="{{ (base + '/') | url }}">{{ l_home | safe }}</a>
          <a href="{{ (base + '/projects/') | url }}">{{ l_projects | safe }}</a>
          <a href="{{ (base + '/media/') | url }}">{{ l_media | safe }}</a>
          <a href="{{ (base + '/training-consulting/') | url }}">{{ l_training | safe }}</a>
          <a href="{{ (base + '/about/') | url }}">{{ l_about | safe }}</a>
          <a href="{{ (base + '/contact/') | url }}">{{ l_contact | safe }}</a>
        </nav>
      {% endif %}
    </div>
  </header>

  <main id="main-content">
    {{ content | safe }}
  </main>

  <footer class="site-footer">
    <div class="container footer-grid">
      <p class="foot-brand">© {{ now | date('yyyy') }} Tamer Mansour</p>
      <div class="foot-social">
        <!-- social icons (same as before) -->
        <a href="https://www.pinterest.com/TamerCreates/" target="_blank" rel="noopener" aria-label="Pinterest">…</a>
        <a href="https://www.tiktok.com/@ai_visionary_tm" target="_blank" rel="noopener" aria-label="TikTok">…</a>
        <a href="https://www.youtube.com/@TamerAI-e5i" target="_blank" rel="noopener" aria-label="YouTube">…</a>
      </div>
    </div>
  </footer>

  <script defer src="{{ '/js/nav.js' | url }}{% if site.assetVersion %}?v={{ site.assetVersion }}{% endif %}"></script>
  <script defer src="{{ '/js/lightbox.js' | url }}{% if site.assetVersion %}?v={{ site.assetVersion }}{% endif %}"></script>
  <script async defer src="https://assets.pinterest.com/js/pinit.js"></script>
  <script>
    // force navigation for the top language switch on some Android browsers
    document.addEventListener('click',function(e){
      var x=e.target.closest('a.lang-switch-top'); if(!x) return;
      var h=x.getAttribute('href'); if(h){ requestAnimationFrame(function(){ window.location.href=h; }); }
    });
  </script>
</body>
</html>
